@startuml
!includeurl https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Context.puml

' Сделаем линии прямоугольными
' skinparam linetype ortho

LAYOUT_TOP_DOWN()
SHOW_PERSON_OUTLINE()
title TO-BE (MVP): Контекст — онлайн-заявка на депозит (банк "Стандарт")

Person(customer, "Клиент", "Смотрит ставки, подает заявку (сайт/интернет-банк)")
Person(callMgr, "Менеджер кол-центра", "Обрабатывает лиды с сайта, консультирует")
Person(depBack, "Сотрудник бэк-офиса депозитов", "Ручная обработка заявок в MVP")
Person(credBack, "Сотрудник бэк-офиса кредитов", "Дает данные по риску для спецставок (ограничение доступа)")

System_Ext(smsGw, "SMS-шлюз телеком-оператора", "SMS-подтверждения и уведомления")
System_Ext(telco, "Телеком-оператор", "Доставка SMS")

System_Boundary(bank, "Банк 'Стандарт' ") {
  System(website, "Сайт", "PHP + React", "Показывает депозиты/ставки, принимает лиды (ФИО/телефон)")
  System(ib, "Интернет-банк", "ASP.NET MVC (.NET 4.5) + MS SQL", "Показывает персональные условия, принимает заявку с SMS-подтверждением")

  System(ccSys, "Система кол-центра", "React + Java + PostgreSQL", "Обработка лидов и звонков (платформа подрядчика)")
  System(abs, "АБС", "Delphi + Oracle (PL/SQL)", "Учет, открытие депозитов, ручная обработка в MVP")

  System_Boundary(mvp, "Контур MVP 'Депозиты онлайн'") {
    System(rates, "Единый источник ставок", "Сервис/хранилище", "Актуальные базовые и спецставки (вместо Excel/почты)")
    System(apps, "Сервис заявок", "Сервис/реестр заявок", "Прием заявок из каналов, гарантированная доставка, статусы")
  }
}

Rel(customer, website, "Смотрит депозиты/ставки, оставляет заявку", "HTTPS")
Rel(website, rates, "Запрашивает актуальные ставки", "HTTPS (TLS)")
Rel(website, ccSys, "Передаёт лид (ФИО, телефон)", "API (TLS)")

Rel(customer, ib, "Подает заявку на депозит", "HTTPS")
Rel(ib, rates, "Получает депозиты/ставки (в т.ч. персональные параметры)", "HTTPS (TLS)")
Rel(ib, apps, "Передает подтвержденную заявку", "API (TLS)")

Rel(ib, smsGw, "SMS OTP для подтверждения заявки", "Интеграция (TLS/защ.канал)")
Rel(smsGw, telco, "Доставка SMS", "SMPP/HTTP")
Rel(telco, customer, "SMS", "SMS")

Rel(apps, abs, "Передаёт заявку/статусы для ручной обработки", "Асинхронно/интеграция")
Rel(depBack, abs, "Ручная обработка заявки и открытие депозита (MVP)", "Десктоп-клиент")
Rel(depBack, rates, "Управляет ставками/правилами (при необходимости)", "Web UI / внутр. доступ")

Rel(depBack, credBack, "Запрос риск-параметров для спецставки (орг.ограничения)", "Внутр. процесс")
Rel(credBack, abs, "Смотрит риск-показатели", "Десктоп-клиент")

Rel(abs, smsGw, "Уведомления клиенту: ставка подтверждена / депозит открыт", "Интеграция")
@enduml
